{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nexport const createGalleryCard = imgInfo =>{\n    return `\n    <li class=\"gallery_card\">\n        <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\">\n            <img class=\"gallery_img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\"/>\n        </a>\n        <div class=\"img_info\">\n                <div class=\"info-item\">\n                    <p class=\"label\">Likes</p>\n                    <p class=\"value\">${imgInfo.likes}</p>\n                </div>\n                <div class=\"info-item\">\n                    <p class=\"label\">Views</p>\n                    <p class=\"value\">${imgInfo.views}</p>\n                </div>\n                <div class=\"info-item\">\n                    <p class=\"label\">Comments</p>\n                    <p class=\"value\">${imgInfo.comments}</p>\n                </div>\n                <div class=\"info-item\">\n                    <p class=\"label\">Downloads</p>\n                    <p class=\"value\">${imgInfo.downloads}</p>\n                </div>\n        </div>\n    </li>\n    `;\n}\n\nexport const lightbox = () => {\n    const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\nlightbox.refresh();\n};","import axios from 'axios';\n\n// export const fetchPhotosByQuery = query =>{\n//     return fetch(`https://pixabay.com/api/?key=49376861-d933ee90ccf66fe84851db78b&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`)\n//             .then(response => {\n//                 if (!response){\n//                     throw new Error (response.status);\n//                 }\n//                 return response.json();\n//             });\n// }\nexport const fetchPhotosByQuery = async (query, page, perPage) =>{\n    try {\n        const response = await axios.get(\n            `https://pixabay.com/api/?key=49376861-d933ee90ccf66fe84851db78b&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`\n        );\n\n        return response.data; \n\n    } catch (error) {\n        console.error(error);\n        throw error;\n    }\n}\n","import \"izitoast/dist/css/iziToast.min.css\";\nimport {createGalleryCard, lightbox} from './js/render-functions';\nimport {fetchPhotosByQuery} from './js/pixabay-api'\nimport iziToast from \"izitoast\";\n\nconst refs = {\n    form: document.querySelector('form'),\n    gallery: document.querySelector('.gallery'),\n    loader: document.querySelector('.loader'),\n    loadMore: document.querySelector('.load_btn'),\n}\nlet page = 1;\nlet search = '';\nlet totalPages = 0;\n\nconst showLoader = () => {\n    refs.loader.style.display = 'block';\n};\n\nconst hideLoader = () => {\n    refs.loader.style.display = 'none';\n};\nconst onSearchFormSubmit = event =>{\n    event.preventDefault();\n\n    search = event.currentTarget.elements[\"search-text\"].value.trim();\n    page = 1;\n    if (search === '') {\n        iziToast.warning({\n            title: 'Warning',\n            message: 'Input must contain letters!',\n            position: 'topRight',\n        });\n        return;\n    }\n    \n    refs.gallery.innerHTML = ''; \n    refs.loadMore.classList.add('is-hidden'); \n\n    showLoader();\n\n    fetchPhotosByQuery(search, page, 10) \n        .then(({hits, totalHits}) => {\n            if (hits.length === 0){\n                iziToast.info({\n                    title: 'Info',\n                    message: 'We are sorry, but you have reached the end of search results!',\n                    position: 'topRight',\n                    timeout: 5000, \n                });\n            \n                refs.form.reset();\n                refs.gallery.innerHTML = ''; \n                return;\n            \n            }\n\n            totalPages = Math.ceil(totalHits / 10);\n            const galleryCard = hits.map(img => createGalleryCard(img)).join('');\n            refs.gallery.innerHTML = galleryCard;\n\n            lightbox();\n\n            if (page < totalPages) {\n                refs.loadMore.classList.remove('is-hidden');\n            }\n\n        })\n        .catch(err => {\n            console.log(err);\n        })\n        .finally(() => {\n            hideLoader();\n        });\n};\n\nconst onLoadMoreClick = () => {\n    page += 1; \n    showLoader();\n\n    fetchPhotosByQuery(search, page, 10)\n        .then(({ hits }) => {\n            const galleryCard = hits.map(img => createGalleryCard(img)).join('');\n            refs.gallery.insertAdjacentHTML('beforeend', galleryCard);\n            const itemHeight = refs.gallery.children[0].getBoundingClientRect().height;\n            smoothScrollBy(itemHeight * 2, 1000);\n            lightbox(); \n\n            if (page >= totalPages) {\n                refs.loadMore.classList.add('is-hidden');\n            }\n        })\n        .catch(err => console.log(err))\n        .finally(() => hideLoader());\n};\nconst smoothScrollBy = (targetScroll, duration) => {\n    const start = window.scrollY;\n    const startTime = performance.now();\n  \n    const animateScroll = currentTime => {\n      const elapsedTime = currentTime - startTime;\n      const progress = Math.min(elapsedTime / duration, 1);\n  \n      const easeOutCubic = t => 1 - Math.pow(1 - t, 3);\n  \n      const newPosition = start + targetScroll * easeOutCubic(progress);\n      window.scrollTo(0, newPosition);\n  \n      if (progress < 1) {\n        requestAnimationFrame(animateScroll);\n      }\n    };\n  \n    requestAnimationFrame(animateScroll);\n  };\n  \nrefs.form.addEventListener('submit', onSearchFormSubmit);\nrefs.loadMore.addEventListener('click', onLoadMoreClick);\n"],"names":["createGalleryCard","imgInfo","lightbox","SimpleLightbox","fetchPhotosByQuery","query","page","perPage","axios","error","refs","search","totalPages","showLoader","hideLoader","onSearchFormSubmit","event","iziToast","hits","totalHits","galleryCard","img","err","onLoadMoreClick","itemHeight","smoothScrollBy","targetScroll","duration","start","startTime","animateScroll","currentTime","elapsedTime","progress","newPosition","t"],"mappings":"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"}