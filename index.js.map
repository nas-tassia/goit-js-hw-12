{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nexport const createGalleryCard = imgInfo =>{\n    return `\n    <li class=\"gallery_card\">\n        <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\">\n            <img class=\"gallery_img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\"/>\n        </a>\n        <div class=\"img_info\">\n                <div class=\"info-item\">\n                    <p class=\"label\">Likes</p>\n                    <p class=\"value\">${imgInfo.likes}</p>\n                </div>\n                <div class=\"info-item\">\n                    <p class=\"label\">Views</p>\n                    <p class=\"value\">${imgInfo.views}</p>\n                </div>\n                <div class=\"info-item\">\n                    <p class=\"label\">Comments</p>\n                    <p class=\"value\">${imgInfo.comments}</p>\n                </div>\n                <div class=\"info-item\">\n                    <p class=\"label\">Downloads</p>\n                    <p class=\"value\">${imgInfo.downloads}</p>\n                </div>\n        </div>\n    </li>\n    `;\n}\n\nexport const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nexport const refreshLightbox = () => {\n    lightbox.refresh();\n};\n\nexport const renderGallery = (galleryContainer, hits) => {\n    const galleryMarkup = hits.map(img => createGalleryCard(img)).join('');\n    galleryContainer.insertAdjacentHTML('beforeend', galleryMarkup);\n    refreshLightbox();\n};\n","import axios from 'axios';\n\n// export const fetchPhotosByQuery = query =>{\n//     return fetch(`https://pixabay.com/api/?key=49376861-d933ee90ccf66fe84851db78b&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`)\n//             .then(response => {\n//                 if (!response){\n//                     throw new Error (response.status);\n//                 }\n//                 return response.json();\n//             });\n// }\nexport const fetchPhotosByQuery = async (query) =>{\n    try {\n        const response = await axios.get(\n            `https://pixabay.com/api/?key=49376861-d933ee90ccf66fe84851db78b&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=1&per_page=10`\n        );\n\n        return response.data; \n\n    } catch (error) {\n        console.error(error);\n        throw error;\n    }\n}\n","import \"izitoast/dist/css/iziToast.min.css\";\nimport {renderGallery, refreshLightbox} from './js/render-functions';\nimport {fetchPhotosByQuery} from './js/pixabay-api'\nimport iziToast from \"izitoast\";\n\nconst refs = {\n    form: document.querySelector('form'),\n    gallery: document.querySelector('.gallery'),\n    loader: document.querySelector('.loader'),\n    loadMore: document.querySelector('.load_btn'),\n}\nlet page = 1;\nlet search = '';\nlet totalPages = 0;\n\nconst showLoader = () => {\n    refs.loader.style.display = 'block';\n};\n\nconst hideLoader = () => {\n    refs.loader.style.display = 'none';\n};\nconst onSearchFormSubmit = event =>{\n    event.preventDefault();\n\n    search = event.currentTarget.elements[\"search-text\"].value.trim();\n    page = 1;\n    if (search === '') {\n        iziToast.warning({\n            title: 'Warning',\n            message: 'Input must contain letters!',\n            position: 'topRight',\n        });\n        return;\n    }\n    \n    refs.gallery.innerHTML = ''; \n    refs.loadMore.classList.add('is-hidden'); \n\n    showLoader();\n\n    fetchPhotosByQuery(search) \n        .then(({hits, totalHits}) => {\n            if (hits.length === 0){\n                iziToast.info({\n                    title: 'Info',\n                    message: 'No images found!',\n                    position: 'topRight',\n                    timeout: 5000, \n                });\n            \n                refs.form.reset();\n                return;\n            \n            }\n\n            totalPages = Math.ceil(totalHits / 10);\n            renderGallery(refs.gallery, hits);\n            refreshLightbox();\n\n            if (page < totalPages) {\n                refs.loadMore.classList.remove('is-hidden');\n            }\n\n        })\n        .catch(err => {\n            console.log(err);\n        })\n        .finally(() => {\n            hideLoader();\n        });\n};\n\nconst onLoadMoreClick = () => {\n    page += 1; \n    refs.loadMore.classList.add('is-hidden'); \n    showLoader();\n\n    fetchPhotosByQuery(search)\n        .then(({ hits }) => {\n            renderGallery(refs.gallery, hits);\n            const itemHeight = refs.gallery.children[0].getBoundingClientRect().height;\n            smoothScrollBy(itemHeight * 2, 1000);\n\n            if (page >= totalPages) {\n                iziToast.info({\n                    title: 'End of Results',\n                    message: 'We are sorry, but you have reached the end of search results',\n                    position: 'topRight',\n                    timeout: 5000,\n                });\n                refs.loadMore.classList.add('is-hidden');\n            } else {\n                refs.loadMore.classList.remove('is-hidden');\n            }\n        })\n        .catch(err => console.log(err))\n        .finally(() => hideLoader());\n};\nconst smoothScrollBy = (targetScroll, duration) => {\n    const start = window.scrollY;\n    const startTime = performance.now();\n  \n    const animateScroll = currentTime => {\n      const elapsedTime = currentTime - startTime;\n      const progress = Math.min(elapsedTime / duration, 1);\n  \n      const easeOutCubic = t => 1 - Math.pow(1 - t, 3);\n  \n      const newPosition = start + targetScroll * easeOutCubic(progress);\n      window.scrollTo(0, newPosition);\n  \n      if (progress < 1) {\n        requestAnimationFrame(animateScroll);\n      }\n    };\n  \n    requestAnimationFrame(animateScroll);\n  };\n  \nrefs.form.addEventListener('submit', onSearchFormSubmit);\nrefs.loadMore.addEventListener('click', onLoadMoreClick);\n"],"names":["createGalleryCard","imgInfo","lightbox","SimpleLightbox","refreshLightbox","renderGallery","galleryContainer","hits","galleryMarkup","img","fetchPhotosByQuery","query","axios","error","refs","page","search","totalPages","showLoader","hideLoader","onSearchFormSubmit","event","iziToast","totalHits","err","onLoadMoreClick","itemHeight","smoothScrollBy","targetScroll","duration","start","startTime","animateScroll","currentTime","elapsedTime","progress","newPosition","t"],"mappings":"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"}